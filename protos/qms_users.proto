syntax = "proto3";

package qms;

import "header.proto";
import "svcerror.proto";

option go_package = "github.com/cyverse-de/p/go/qms";

option java_multiple_files = true;
option java_package = "org.cyverse.de.protobufs";
option java_outer_classname = "QMSUSerProtobufs";

/**
 * A representation of a user in the QMS system.
 */
message QMSUser {
    // A user's unique identifier in QMS.
    string uuid = 1;

    // A user's username in QMS.
    string username = 2;
}

/**
 * A response to a request for info about a QMS user.
 */
message QMSUserResponse {
     // Contains telemetry information
    header.Header header = 1;
    
    // Error information generated by the request handler.
    svcerror.ServiceError error = 2;

    // The user returned by the request handler.
    QMSUser user = 3;
}

/**
 *  A response to a request for info about a list of users.
 */
message QMSUserList {
     // Contains telemetry information
    header.Header header = 1;

    // Error information generated by the request handler.
    svcerror.ServiceError error = 2;
    
    // The user list returned by the request handler.
    repeated QMSUser users  = 3;
}

/**
 * A request to add a user to the QMS system.
 */
message AddUserRequest {
     // Contains telemetry information
    header.Header header = 1;

    // The username for the user being added to the system.
    string username = 3;

    // The name of the plan the user should be subscribed to.
    string plan_name = 4;

    // True if the user paid for the subscription.
    bool paid = 5;

    // The number of subscription periods that the subscription will be good for. The subscription period is one year,
    // so purchasing a subscription for 3 periods will create a subscription for 3 years. Consumable resources are also
    // allocated based on the number of periods, so if a subscription plan comes with 2000 CPU Hours, for example, then
    // a user who purchases 3 subscription periods will get 6000 CPU hours to use over the course of three years.
    int32 periods = 6;

    // The end-date of the subscription. Accepted formats are `YYYY-MM-DD`, `YYYY-MM-DDThh:mm:ss`,
    // `YYYY-MM-DDThh:mm:ssZ` and `YYYY-MM-DDThh:mm:ss+hh:mm`. Date and tiestamps without time zones are assumed to
    // be in the time zone used by the CyVerse Discovery Environment itself.
    string end_date = 7;
}

/**
 * A response to a request to add a user to the QMS system.
 */
message AddUserResponse {
     // Contains telemetry information
    header.Header header = 1;

    // Error information generated by the request handler.
    svcerror.ServiceError error = 2;

    // The unique identfier of the newly added user.
    string uuid = 3;

    // The username of the newly added user.
    string username = 4;

    // The name of the plan the newly added user is subscribed to.
    string plan_name = 5;

    // The unique identifier for the plan the newly added user is subscribed to.
    string plan_uuid = 6;
}
